	
一、RDB持久化机制
	
	1、概念
		就是把内存数据以快照的形式保存到磁盘上。
		RDB持久化：是指在指定的时间间隔内，执行指定次数的写操作，将内存中的数据集快照写入磁盘中，它是Redis默认的持久化方式。执行完操作后，在指定目录下会生成一个dump.rdb文件，Redis重启的时候，通过加载`dump.rdb`文件来恢复数据。

	2、触发机制
	（1）手动触发
		save：同步，会阻塞当前Redis服务器进程，直到RDB过程完成为止。
		bgsave：异步，会启动一个子进程来执行RDB过程，父进程继续处理客户端请求。
	
	（2）自动触发
		根据配置的时间间隔和变更次数自动触发，例如，save 300 10，即300秒执行10次持久化操作。

	3、特点
	（1）优点：适合大规模的数据恢复场景，如备份，全量复制等
	（2）缺点：没办法做到实时持久化/秒级持久化。
	

二、ROF持久化机制

	1、概念
		AOF（append only file）持久化，采用日志的形式来记录每个写操作，追加到文件中，重启时再重新执行AOF文件中的命令来恢复数据。
		它主要解决数据持久化的实时性问题，默认是不开启的。
	
	2、工作流程
		（1）所有的写⼊命令会追加到缓冲区中。
		（2）AOF缓冲区根据对应的策略向硬盘做同步操作。
		（3）随着AOF⽂件越来越⼤，需要定期对AOF⽂件进⾏重写，达到压缩的⽬的。
		（4）当Redis服务器启动时，可以加载AOF⽂件进⾏数据恢复。
		
		注意：
		（1）AOF 为什么需要缓冲区？如果每次写 AOF ⽂件都直接同步硬盘，性能从内存的读写变成 IO 读写，必然会下降。先写⼊缓冲区可以有效减少 IO 次数。
		
		（2）缓冲区同步策略
			always：每次写入缓冲区后直接写入AOF文件中。
			everysec（默认）：写入缓冲区后，不进行同步，一秒后再进行写入AOF文件。
			no：只执行write操作（也就是只缓存）由操作系统控制写入AOF文件的频率。

		（3）重写机制
			为了避免AOF文件太大问题，控制文件大小并优化性能，Redis支持运行时触发AOF文件重写（rewrite）机制，用以压缩AOF文件的大小。
			

	3、特点
	（1）优点：数据的一致性和完整性更高。
	（2）缺点：AOF记录的内容越多，文件越大，数据恢复变慢。


三、混合持久化机制

	1、概念
		在开启混合持久化的情况下，AOF重写时会把Redis的持久化数据，以RDB的格式写入到AOF文件的开头，之后的数据再以AOF的格式化追加的文件的末尾。

	2、特点
	（1）优点：结合了RDB和AOF持久化的优点，开头为RDB格式，使得Redis可以更快的启动，同时结合 AOF的优点，又减低了大量数据丢失的风险。
	（2）缺点：AOF文件中添加了RDB格式的内容，就让AOF文件的可读性变得很差。
	