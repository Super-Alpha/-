![[Pasted image 20250219161909.png]]

CPU：top、 perf、 strace
内存：free 、top、 ps 
磁盘：df 、iostat、 lsof
网络：ip 、netstat、 ifconfig

一、CPU
1、top（实时监控系统性能）

		-d <seconds> 设置刷新间隔时间（秒）
		-p <pid> 监视指定pid的进程
		-u <username> 显示执行用户的进程（work/root）
		-o <name> 指定特定的‘列名’来排序
		
	展示列表：
		PID: 进程ID。
		USER: 进程所有者用户名。
		PR: 进程优先级。
		NI: nice值，负值表示更高优先级，正值表示更低优先级。
		VIRT: 进程使用的虚拟内存总量。
		RES: 进程使用的实际物理内存（常驻集大小）。
		SHR: 共享内存大小。
		S: 进程状态 (D=不可中断, R=运行, S=休眠, T=跟踪/停止, Z=僵尸)。
		%CPU: 最近一次更新周期内，该进程占用的CPU百分比。
		%MEM: 进程占用的物理内存百分比。
		TIME+: 进程累计使用的CPU时间，精确到百秒。
		COMMAND: 启动该进程的命令名称或命令行。

2、ps（查看当前系统中进程的信息）

		-A：显示所有进程信息，等同于-e选项。
		-u：显示与指定用户相关的进程信息。
		-l：显示更详细的进程信息，包括进程状态、进程ID、CPU占用率、内存占用率等。
		-f：显示完整格式的进程信息，包括进程的父进程ID、进程组ID、控制终端等。
		-e：显示所有进程信息，包括无终端进程。
		-aux：显示所有进程信息，包括所有用户的进程和无终端进程。
	
	例如：
		ps aux ： 显示当前系统中所有进程的详细信息，包括所有用户的进程和无终端进程
		ps -ef ： 显示所有进程的完整信息，包括命令行参数
		ps -u <username> : 显示指定用户的所有进程信息 
		ps -p <pid> u: 显示指定进程ID对应的全量信息

	结果列表：
		1. USER：进程所属的用户。
		2. PID：进程的ID号。
		3. %CPU：进程占用的CPU使用率。
		4. %MEM：进程占用的内存使用率。
		5. VSZ：进程占用的虚拟内存大小（KB）。
		6. RSS：进程占用的实际内存大小（KB）。
		7. TTY：进程所在的终端设备。
		8. STAT：进程的状态。
		    R表示运行中
		    S表示睡眠等待
		    Z表示僵尸进程
		    D表示休眠（不可中断）
		    T表示暂停（或跟踪状态）
		    W表示进入内存交换（从内存中移动到交换空间）
		    X表示死亡（进程已经退出）
		    Ss表示进程处于休眠状态，且为会话领导者（session leader）。这种状态通常出现在守护进程（daemon）中，该进程在后台运行，等待某些事件的发生。在这种状态下，进程不会占用CPU资源，但会保持在内存中等待事件的发生。
		    I<表示进程被标记为“idle”（空闲）状态。这种状态通常出现在内核里的线程（kernel thread）中，表示该线程正在等待某些条件的发生，例如等待I/O操作完成。在这种状态下，进程不会占用CPU资源，但会保持在内存中等待条件的满足。
		    R+表示进程正在运行并且具有较高的优先级。
		9. START：进程启动的时间。
		10. TIME：进程运行的累计CPU时间。
		11. COMMAND：进程的命令行。

3、perf（对 CPU 性能事件（如 CPU 使用、缓存命中/未命中、指令计数、上下文切换等）的详细追踪，能够为系统和程序提供非常细致的性能信息）

	例如：
		perf stat -p <pid> // 统计指定进程的整体性能数据
	
		perf stat -e -p <pid> // 分析缓存性能
		
		perf record -p <pid> //记录程序运行时的性能数据

		perf report //配合record，查看record生成的报告
 
		perf trace  //跟踪系统调用和事件，帮助分析程序的系统级行为

		perf stat -P ALL  //查看各个CPU核心的负载和性能状况

		perf top -g -p <pid>  //实时查看应用程序的性能热点

4、pidstat（分析和监控每个进程的 CPU、内存、I/O 等资源的使用情况）

		pidstat [选项] [间隔秒数] [次数] 

		-p: 指定要查看的进程 ID。
		-u: 显示进程的 CPU 使用情况。
		-r: 显示进程的内存使用情况。
		-d: 显示进程的 I/O 使用情况（包括读取和写入数据量）。
		-t: 显示每个线程的统计信息，而不是整个进程。
		-w: 显示进程的上下文切换统计信息。
		-v: 显示进程的虚拟内存使用情况。

		例如：
			pidstat -u -p <pid> 1 3 // CPU使用情况
			pidstat -r -p 21537 1 3 // 内存使用情况
			pidstat -d -p 21537 1 3 // 磁盘使用情况

二、内存

1、free（查看系统内存信息）
	
	-b：以字节（bytes）为单位显示内存信息。
	-k：以千字节（kilobytes）为单位显示内存信息。这是默认单位。
	-m：以兆字节（megabytes）为单位显示内存信息。
	-g：以千兆字节（gigabytes）为单位显示内存信息。
	-h：以人类可读（human-readable）格式显示内存信息，自动选择合适的单位（B/KB/MB/GB）。

	列表：
	
	total：物理内存总量。
		该值表示系统中所有的物理内存（RAM）的总大小。在上例中，系统有 31GB 的物理内存。
	
	used：已使用的物理内存。
		该值表示目前被操作系统和应用程序使用的内存，包括程序本身占用的内存以及用于缓存和缓冲的数据。上例中，已使用内存为 9.0GB。
	
	free：空闲的物理内存。
		这是当前没有被使用的物理内存。在上例中，空闲内存为 12GB。
	
	shared：共享内存。
		该字段表示用于进程间共享内存的部分，通常是 tmpfs 或类似机制分配的内存。在上例中，共享内存为 326MB。
	
	buff/cache：缓冲和缓存占用的内存。
		Linux 系统会尽量利用空闲内存来缓存文件系统中的数据，以加速文件读取。这部分内存可以在需要时快速释放给应用程序使用。上例中，缓存和缓冲占用了 9.8GB。
	
	available：可用的内存。
		该值表示系统中实际可供新进程使用的内存，包括 free 内存和可以随时回收的 buff/cache 内存。上例中，可用内存为 21GB。这个字段比 free 更能准确反映系统的内存可用性。


三、磁盘

1、df（查看磁盘空间使用情况，以及磁盘挂载信息）
	
		-h ： 以人类可读的格式显示

2、du （查看目录或文件占用的磁盘空间）

	    -sh ：汇总统计

3、iostat （查看磁盘 I/O 和CPU的统计信息）

		 -x ： 显示详细的磁盘统计信息，包括更多的 I/O 性能指标，如响应时间、队列长度等。

	例如：
		（1）iostat -m -x 1 
				 -m ：以MB为单位
				 -x：输出扩展信息
				 1 ：刷新频率为1秒

		（2）iostat -d /dev/sda1 -m -x 1  // 查看磁盘sda1的io情况

4、iotop（监控进程的磁盘 I/O 活动）

		-o：只显示有 I/O 活动的进程，避免显示那些没有任何 I/O 操作的进程。
		-b：批量模式，用于记录日志或分析，输出一次后自动退出，常用于将数据重定向到文件。
		-n N：指定显示的刷新次数。例如，iotop -n 5 表示刷新 5 次后自动退出。
		-d：指定每次刷新的时间间隔（以秒为单位），默认为 1 秒。
		-P：只显示每个进程（不显示线程级别的 I/O 信息）。
		-k：以 KB/s 为单位显示 I/O 速率，默认显示 B/s。
		-a：显示自进程启动以来的 I/O 总量，而不仅仅是当前时间段内的数据。
		-p PID：只显示指定进程的 I/O 信息。

	列表：
		TID：线程 ID (Thread ID)，即正在执行 I/O 操作的线程或进程的 ID。
		PRIO：I/O 优先级。I/O 优先级与进程的调度优先级不同，表示该线程在 I/O 调度中的优先级。
		USER：启动该进程或线程的用户。
		DISK READ：磁盘读取速率。表示该进程从磁盘读取数据的速度（B/s、KB/s 等）。
		DISK WRITE：磁盘写入速率。表示该进程向磁盘写入数据的速度。
		SWAPIN：进程从交换分区中读取数据的百分比，表示该进程访问虚拟内存的频率。如果这个数值较高，意味着系统可能内存不足。
		IO：I/O 等待时间，表示进程因为等待 I/O 操作而被阻塞的时间比例。这个值越高，意味着进程等待磁盘响应的时间越多。
		COMMAND：进程或线程的执行命令。

5、lsof（列出当前系统打开的文件）

		 -a： 显示所有打开的文件，不仅仅是已经被映射到内存中的文件。
		 -c： <字符串>` 或 `--command <字符串>`：只显示指定命令的打开文件。
		 -d： <文件描述符>`只显示指定文件描述符的文件。
		 -f： 指定输出字段。
		 -h： 显示帮助信息。
		 -i： 显示网络相关的文件（如套接字），可以通过端口号或协议类型进行筛选。
		 -m： 显示占用指定端口的进程。
		 -n： 不解析网络地址，显示数字形式的端口号和进程ID。
		 -p： 只显示指定进程ID的打开文件。
		 -t： 仅显示文件描述符。
		 -u： 只显示指定用户的所有打开文件。
		 -v： 详细显示信息，包括进程的环境和文件的状态。
		 -x： 显示额外的信息，如文件权限和文件系统类型。

		例如：
			lsof file_name  // 列出谁正在使用某个文件，也就是说查找某个文件相关的进程
			lsof -u userName // 列出某一个用户打开的文件
			lsof -i tcp/udp // 查看网络连接 


四、网络

1、netstat （查看网络连接及状态）

		-a：显示所有连接和监听端口
		-t：仅显示 TCP 连接
		-u：仅显示 UDP 连接
		-l：显示监听中的端口（仅显示服务端口）
		-n：使用数字地址和端口，而不是域名解析
		-r：显示路由表
		-i：显示网络接口的统计信息
		-s：显示网络协议统计信息
		-p：显示每个连接的 PID 和程序名称
		-v：显示详细信息
		-c：持续更新显示网络状态，直到按下 Ctrl+C

		例如:
			netstat -tulnp | grep <进程ID> // 查看某一进程的网络连接状况
			

2、ifconfig（ 查看网络接口状态）
	
	（1）查看所有接口的配置信息
			ifconfig
	
	（2）启用eth0接口
			ifconfig eth0 up
	
	  (3)禁用eth0接口
			ifconfig eth0 down
	
	注：ifconfig 可以查看和管理网络接口的各种信息，如IP地址、MAC地址、网络接口的状态、MTU、混杂模式等


3、iftop （实时监控网络流量）

	（1）显示eth0接口的网络流量
		sudo iftop -i eth0
		
	  (2)显示wlan0接口的网络流量，并设置 2 秒刷新一次
		sudo iftop -i wlan0 -t 2
		
	  (3)查看源 IP 地址为`192.168.1.100`的流量
		sudo iftop -i eth0 -f "src host 192.168.1.100"
      
      (4)查看HTTP（端口80）的流量
	    sudo iftop -i eth0 -f "dst port 80"
	    
	注：iftop快速查看和分析网络接口上的数据流量、活动连接以及带宽使用情况。通过交互式的命令行界面和多种过滤、排序选项，常用于排查网络性能问题和监控网络活动。

	
4、ethtool（查看网络接口相关信息）

	（1）查看eth0网卡的详细信息
			ethtool eth0
	
	 (2) 查看eth0网卡的统计信息
		 ethtool -S eth0
	
	注：ethtool 可以查看和调整网卡的各种参数，适用于网络性能调优、故障排查和硬件配置。通过该工具，可以快速获取网卡的详细信息、网络流量统计、驱动程序信息以及进行低级别的设置。


五、其他
	
	1、kill 

		（1）关闭进程
			kill PID

	2、watch（定期执行某个命令，并显示其输出）

		例如：
			 watch -n 1 "lsof -i -a -p <pid>"  //实时查看某一进程的网络连接
			
